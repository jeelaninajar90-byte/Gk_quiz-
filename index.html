<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>GK Quiz - Levels + Ads</title>

<!-- PopCash Verification -->
<meta name="ppck-ver" content="556710499fb5e0a5106abe0a469ff325" />

<style>
  body {
    font-family:'Poppins',sans-serif;
    margin:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    min-height:100vh;
    background:linear-gradient(135deg,#0f172a,#1e293b);
    color:#fff;
    padding:10px;
  }
  .container {
    width:94%;
    max-width:720px;
    background:rgba(255,255,255,0.04);
    border-radius:12px;
    padding:18px;
    box-shadow:0 6px 30px rgba(0,0,0,0.4);
    position:relative;
  }
  .header { display:flex; justify-content:space-between; align-items:center; margin-bottom:12px; }
  .title { font-weight:700; font-size:18px; }
  .meta { font-size:14px; color:#cbd5e1; }
  .timer { text-align:right; font-weight:600; margin-bottom:8px; }
  .question { font-size:20px; font-weight:600; margin-bottom:12px; }
  .options { display:grid; gap:10px; }
  .option {
    background:rgba(255,255,255,0.06);
    border:0; padding:12px; border-radius:10px;
    color:#fff; cursor:pointer; font-size:15px;
    text-align:left; transition:0.18s;
  }
  .option:hover { transform:translateY(-3px); background:rgba(255,255,255,0.12); }
  .correct { background:#16a34a !important; }
  .wrong { background:#dc2626 !important; }
  .progress-bar { background:rgba(255,255,255,0.08); height:8px; border-radius:6px; overflow:hidden; margin-top:12px; }
  .progress { height:8px; background:#3b82f6; width:0%; transition:width .25s; }
  .footer { text-align:center; margin-top:14px; font-size:13px; color:#94a3b8; }
  .controls { display:flex; gap:8px; margin-top:10px; }
  .btn { background:#111827; color:#fff; border:none; padding:8px 12px; border-radius:8px; cursor:pointer; }
  .small { font-size:13px; color:#9ca3af; }

  /* Ad container styling */
  #adsterra-ad {
    margin-top:15px;
    text-align:center;
  }
</style>
</head>
<body>
  <div class="container" id="app">
    <div class="header">
      <div>
        <div class="title">GK Quiz</div>
        <div class="small" id="levelDisplay">Level: 1</div>
      </div>
      <div>
        <div class="meta" id="scoreDisplay">Score: 0</div>
      </div>
    </div>

    <div class="timer" id="timerDisplay">Time: 15s</div>

    <div class="question" id="question">Loading...</div>
    <div class="options" id="options"></div>

    <div class="progress-bar"><div id="progress" class="progress"></div></div>

    <div class="controls">
      <button class="btn" id="resetBtn">Reset Progress</button>
      <div style="flex:1"></div>
      <div class="small">Questions/Level: <span id="qPerLevel"></span></div>
    </div>

    <!-- ‚úÖ Adsterra Banner (always visible) -->
    <div id="adsterra-ad">
      <iframe src="https://www.highperformanceformat.com/1fb6a2cbe39ff164db744838c5463e34/invoke.html"
        style="width:160px; height:300px; border:none; overflow:hidden;"
        scrolling="no" frameborder="0"></iframe>
    </div>

    <div class="footer">Made with ‚ù§Ô∏è ‚Äî Ads after each level</div>
  </div>

<script>
/* ----------------- CONFIG ------------------ */
const POP_UID = '496125';
const POP_WID = '747430';
const POP_FBACK = 'up';
const timerLimit = 15;
const questionsPerLevel = 5;
const minScoreToPass = 30;
const pointsPerCorrect = 10;
const totalLevels = 100;

/* ------------- QUESTIONS -------------- */
const questionPool = [
  {q:'What is the capital of India?', options:['Mumbai','Delhi','Kolkata','Chennai'], answer:1},
  {q:'Who wrote the National Anthem?', options:['Rabindranath Tagore','Bankim Chandra','Kavi Pradeep','Sarojini Naidu'], answer:0},
  {q:'Which planet is known as the Red Planet?', options:['Venus','Mars','Jupiter','Mercury'], answer:1},
  {q:'Who was the first President of India?', options:['Rajendra Prasad','Zakir Hussain','V.V. Giri','Abdul Kalam'], answer:0},
  {q:'Longest river in the world?', options:['Amazon','Nile','Yangtze','Mississippi'], answer:1},
];

/* ------------- LEVELS ---------------- */
const levels = [];
for (let lvl = 0; lvl < totalLevels; lvl++) {
  const shuffled = [...questionPool].sort(()=>0.5 - Math.random());
  const chosen = shuffled.slice(0, Math.min(questionsPerLevel, shuffled.length)).map(q=>{
    const opts = q.options.map((t,i)=>({t,orig:i})).sort(()=>0.5 - Math.random());
    return { q: q.q, options: opts.map(o=>o.t), answer: opts.findIndex(o=>o.orig === q.answer) };
  });
  levels.push({ minScore: minScoreToPass, questions: chosen });
}

/* ------------- STATE ---------------- */
let currentLevel = parseInt(localStorage.getItem('currentLevel')) || 0;
let currentIndex = parseInt(localStorage.getItem('currentIndex')) || 0;
let totalScore = parseInt(localStorage.getItem('totalScore')) || 0;
let levelScore = parseInt(localStorage.getItem('levelScore')) || 0;
let timer = null;
let timeLeft = timerLimit;

/* ------------- DOM refs ---------------- */
const levelDisplay = document.getElementById('levelDisplay');
const scoreDisplay = document.getElementById('scoreDisplay');
const timerDisplay = document.getElementById('timerDisplay');
const questionEl = document.getElementById('question');
const optionsEl = document.getElementById('options');
const progressEl = document.getElementById('progress');
const resetBtn = document.getElementById('resetBtn');
const qPerLevelEl = document.getElementById('qPerLevel');
qPerLevelEl.textContent = questionsPerLevel;

/* ------------- Helpers ---------------- */
function saveProgress(){
  localStorage.setItem('currentLevel', currentLevel);
  localStorage.setItem('currentIndex', currentIndex);
  localStorage.setItem('totalScore', totalScore);
  localStorage.setItem('levelScore', levelScore);
}

function updateUI(){
  levelDisplay.textContent = `Level: ${currentLevel+1}`;
  scoreDisplay.textContent = `Score: ${totalScore}`;
}

function startTimer(){
  clearInterval(timer);
  timeLeft = timerLimit;
  timerDisplay.textContent = `Time: ${timeLeft}s`;
  timer = setInterval(()=>{
    timeLeft--;
    timerDisplay.textContent = `Time: ${timeLeft}s`;
    if (timeLeft <= 0) {
      clearInterval(timer);
      disableOptions();
      setTimeout(()=> nextQuestion(false), 800);
    }
  },1000);
}

function disableOptions(){
  document.querySelectorAll('.option').forEach(b => b.disabled = true);
}

/* ------------- PopCash ---------------- */
function showPopCash(){
  try {
    var pop_tag = document.createElement('script');
    pop_tag.src = '//cdn.popcash.net/show.js';
    window.uid = POP_UID;
    window.wid = POP_WID;
    window.pop_fback = POP_FBACK;
    document.body.appendChild(pop_tag);
  } catch(e) { console.warn(e); }
}

/* ------------- Adsterra refresh -------- */
function refreshAdsterra(){
  document.getElementById("adsterra-ad").innerHTML =
    '<iframe src="https://www.highperformanceformat.com/1fb6a2cbe39ff164db744838c5463e34/invoke.html" style="width:160px; height:300px; border:none; overflow:hidden;" scrolling="no" frameborder="0"></iframe>';
}

/* ------------- Game Logic -------------- */
function loadQuestion(){
  if (currentLevel >= levels.length){ showFinalResult(); return; }
  const lvlData = levels[currentLevel];
  if (currentIndex >= lvlData.questions.length){ onLevelFinish(); return; }

  const qobj = lvlData.questions[currentIndex];
  updateUI(); startTimer();

  questionEl.textContent = `${currentIndex+1}. ${qobj.q}`;
  optionsEl.innerHTML = '';
  qobj.options.forEach((opt, idx)=>{
    const btn = document.createElement('button');
    btn.className='option';
    btn.textContent = opt;
    btn.onclick = ()=>selectAnswer(idx, btn);
    optionsEl.appendChild(btn);
  });
  updateProgress();
  saveProgress();
}

function selectAnswer(selectedIdx, btn){
  clearInterval(timer);
  const lvlData = levels[currentLevel];
  const qobj = lvlData.questions[currentIndex];
  const correct = qobj.answer;
  document.querySelectorAll('.option').forEach(b=>b.disabled=true);
  if (selectedIdx===correct){ btn.classList.add('correct'); totalScore+=pointsPerCorrect; levelScore+=pointsPerCorrect; }
  else btn.classList.add('wrong');
  updateUI(); saveProgress();
  setTimeout(()=>nextQuestion(true),800);
}

function nextQuestion(){
  currentIndex++;
  saveProgress();
  const lvlData = levels[currentLevel];
  if (currentIndex >= lvlData.questions.length) onLevelFinish();
  else loadQuestion();
}

function onLevelFinish(){
  clearInterval(timer);
  const lvlData = levels[currentLevel];
  const passed = (levelScore >= lvlData.minScore);
  if (passed){
    alert(`üéâ Level ${currentLevel+1} Passed! Score: ${levelScore}`);
    showPopCash();     // ‚úÖ show popup ad
    refreshAdsterra(); // ‚úÖ reload banner ad
    currentLevel++; currentIndex=0; levelScore=0;
    saveProgress();
    setTimeout(()=>loadQuestion(),1400);
  } else {
    alert(`‚ùå Level ${currentLevel+1} Failed! Try again.`);
    currentIndex=0; levelScore=0;
    saveProgress(); loadQuestion();
  }
}

function updateProgress(){
  const totalQ = levels.reduce((sum,l)=>sum+l.questions.length,0);
  const completed = levels.slice(0,currentLevel).reduce((sum,l)=>sum+l.questions.length,0)+currentIndex;
  const percent = (completed/totalQ)*100;
  progressEl.style.width = percent+'%';
}

function showFinalResult(){
  clearInterval(timer);
  questionEl.textContent='üèÅ Quiz Complete!';
  optionsEl.innerHTML=`<h2>Your Total Score: ${totalScore}</h2>`;
  progressEl.style.width='100%';
}

resetBtn.onclick=()=>{
  if(confirm('Reset progress?')){
    localStorage.clear();
    currentLevel=0;currentIndex=0;totalScore=0;levelScore=0;
    updateUI();loadQuestion();
  }
};

/* Start */
updateUI();
loadQuestion();
</script>
</body>
</html>